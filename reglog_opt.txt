test
%%
dataLibrary = 'data_opt_unal';

%%
lightp = 16;
initialIntI0 = 80;
finalIntI0 = 200;
tf = 300;
b_exp = 0.5;

P0 = [lightp;initialIntI0;finalIntI0;tf;b_exp];
fitnessFun = @(P) fitnessFunction(P,dataLibrary);
[f0,solution0] = fitnessFunction(P0,dataLibrary);

|     |I (umol/m2 s) |         Biomass (g/L)         |      Compounds (mM)   |        |                      Rates (mmol/gDW h)                 |     |
 Time   intI   extI      X      TAG     STA      XT      N       C       O       Qn     rx     rTAG     rSTA   rN_kin     rN       rC      rO2     AI      LR      SP
  0.0    80.0     0.0   0.070   0.015   0.015   0.100   1.514   1.724   1.724   6.500   0.000   0.003   0.132   -0.033   0.000   -5.064   5.137     6   0.041   0.000
  1.0    88.4     0.0   0.070   0.015   0.024   0.109   1.511   1.724   1.724   6.533   0.030   0.004   0.022   -0.029   -0.152   -2.177   2.374     6   0.114   0.577
  2.0    91.9     0.0   0.072   0.015   0.026   0.113   1.509   1.724   1.724   6.410   0.022   0.002   0.007   -0.043   -0.114   -1.244   1.375     7   0.116   0.758
  3.0    94.6     0.0   0.074   0.016   0.026   0.116   1.506   1.724   1.724   6.339   0.021   0.002   0.006   -0.051   -0.110   -1.182   1.301     8   0.117   0.770
  4.0    96.8     0.0   0.075   0.016   0.027   0.118   1.502   1.724   1.724   6.281   0.022   0.002   0.007   -0.058   -0.111   -1.204   1.336     9   0.118   0.766
  5.0    98.8     0.0   0.077   0.016   0.027   0.120   1.498   1.724   1.724   6.228   0.022   0.002   0.007   -0.064   -0.112   -1.227   1.361     9   0.118   0.761
  6.0   100.6     0.0   0.079   0.016   0.028   0.122   1.493   1.724   1.724   6.179   0.022   0.002   0.007   -0.070   -0.114   -1.249   1.380    10   0.119   0.757
  7.0   102.2     0.0   0.080   0.016   0.028   0.125   1.488   1.724   1.724   6.135   0.022   0.002   0.007   -0.075   -0.115   -1.270   1.402    10   0.120   0.753
  8.0   103.8     0.0   0.082   0.016   0.029   0.128   1.482   1.724   1.724   6.095   0.023   0.002   0.008   -0.079   -0.116   -1.289   1.422    10   0.121   0.749
  9.0   105.2     0.0   0.084   0.017   0.030   0.130   1.475   1.724   1.724   6.058   0.023   0.002   0.008   -0.083   -0.117   -1.306   1.441    10   0.121   0.746
 10.0   106.6     0.0   0.086   0.017   0.030   0.133   1.468   1.724   1.724   6.025   0.023   0.002   0.008   -0.087   -0.118   -1.322   1.458    11   0.122   0.743
 11.0   107.9     0.0   0.088   0.017   0.031   0.136   1.461   1.724   1.724   5.993   0.023   0.003   0.008   -0.090   -0.118   -1.335   1.473    11   0.123   0.740
 12.0   109.1     0.0   0.090   0.017   0.032   0.139   1.453   1.724   1.724   5.965   0.023   0.003   0.008   -0.093   -0.119   -1.346   1.485    11   0.123   0.737
 13.0   110.3     0.0   0.092   0.018   0.032   0.142   1.444   1.724   1.724   5.939   0.023   0.003   0.009   -0.095   -0.119   -1.356   1.496    11   0.124   0.735
 14.0   111.4     0.0   0.094   0.018   0.033   0.145   1.436   1.724   1.724   5.915   0.023   0.003   0.009   -0.098   -0.120   -1.365   1.506    11   0.124   0.733
 15.0   112.5     0.0   0.096   0.018   0.034   0.148   1.426   1.724   1.724   5.893   0.023   0.003   0.009   -0.100   -0.120   -1.372   1.513    11   0.124   0.731
 16.0     0.0     0.0   0.098   0.018   0.035   0.152   1.417   1.724   1.724   5.873   0.005   0.000   -0.006   -0.101   -0.027   0.024   -0.007     0   0.125   0.729
 17.0     0.0     0.0   0.099   0.018   0.034   0.151   1.407   1.724   1.724   5.947   0.005   0.000   -0.006   -0.093   -0.027   0.024   -0.007     0   0.123   0.727
 18.0     0.0     0.0   0.099   0.018   0.034   0.151   1.398   1.724   1.724   6.013   0.005   0.000   -0.006   -0.085   -0.026   0.023   -0.007     0   0.122   0.715
 19.0     0.0     0.0   0.100   0.018   0.033   0.151   1.389   1.724   1.724   6.071   0.005   0.000   -0.006   -0.078   -0.026   0.023   -0.007     0   0.121   0.704
 20.0     0.0     0.0   0.100   0.018   0.032   0.151   1.382   1.724   1.724   6.123   0.005   0.000   -0.006   -0.072   -0.025   0.022   -0.007     0   0.120   0.692
 21.0     0.0     0.0   0.101   0.018   0.032   0.151   1.374   1.724   1.724   6.170   0.005   0.000   -0.006   -0.067   -0.025   0.022   -0.007     0   0.119   0.681
 22.0     0.0     0.0   0.101   0.018   0.031   0.151   1.368   1.724   1.724   6.211   0.005   0.000   -0.006   -0.062   -0.025   0.021   -0.006     0   0.119   0.670
 23.0     0.0     0.0   0.102   0.019   0.031   0.151   1.361   1.724   1.724   6.249   0.004   0.000   -0.006   -0.058   -0.024   0.021   -0.006     0   0.118   0.660

|     |I (umol/m2 s) |         Biomass (g/L)         |      Compounds (mM)   |        |                      Rates (mmol/gDW h)                 |     |
 Time   intI   extI      X      TAG     STA      XT      N       C       O       Qn     rx     rTAG     rSTA   rN_kin     rN       rC      rO2     AI      LR      SP
 24.0   113.6     0.0   0.102   0.019   0.030   0.151   1.355   1.724   1.724   6.282   0.027   0.003   0.015   -0.054   -0.138   -1.769   1.937    12   0.118   0.649
 25.0   114.6     0.0   0.105   0.019   0.032   0.155   1.350   1.724   1.724   6.197   0.027   0.003   0.016   -0.063   -0.139   -1.809   1.990    12   0.119   0.639
 26.0   115.6     0.0   0.108   0.019   0.033   0.160   1.343   1.724   1.724   6.121   0.027   0.003   0.015   -0.071   -0.137   -1.760   1.935    12   0.120   0.646
 27.0   116.6     0.0   0.111   0.020   0.035   0.165   1.336   1.724   1.724   6.055   0.026   0.003   0.014   -0.077   -0.134   -1.708   1.880    12   0.121   0.654
 28.0   117.6     0.0   0.114   0.020   0.036   0.170   1.327   1.724   1.724   5.998   0.026   0.003   0.013   -0.083   -0.132   -1.661   1.830    12   0.122   0.661
 29.0   118.5     0.0   0.116   0.020   0.038   0.175   1.318   1.724   1.724   5.950   0.025   0.003   0.013   -0.088   -0.129   -1.620   1.786    12   0.123   0.667
 30.0   119.4     0.0   0.119   0.021   0.039   0.179   1.308   1.724   1.724   5.908   0.025   0.003   0.012   -0.092   -0.127   -1.582   1.747    13   0.124   0.672
 31.0   120.3     0.0   0.122   0.021   0.041   0.184   1.297   1.724   1.724   5.873   0.024   0.003   0.012   -0.095   -0.125   -1.545   1.707    13   0.125   0.676
 32.0   121.2     0.0   0.125   0.021   0.042   0.189   1.285   1.724   1.724   5.843   0.024   0.003   0.011   -0.097   -0.123   -1.508   1.668    13   0.125   0.680
 33.0   122.0     0.0   0.128   0.022   0.044   0.194   1.273   1.724   1.724   5.818   0.023   0.003   0.011   -0.099   -0.120   -1.476   1.633    13   0.126   0.683
 34.0   122.8     0.0   0.131   0.022   0.045   0.198   1.260   1.724   1.724   5.796   0.023   0.003   0.011   -0.101   -0.118   -1.446   1.601    13   0.126   0.686
 35.0   123.7     0.0   0.134   0.022   0.046   0.203   1.247   1.724   1.724   5.778   0.023   0.003   0.010   -0.102   -0.117   -1.418   1.571    13   0.127   0.689
 36.0   124.5     0.0   0.137   0.023   0.048   0.208   1.233   1.724   1.724   5.763   0.022   0.003   0.010   -0.102   -0.115   -1.392   1.543    14   0.127   0.691
 37.0   125.2     0.0   0.140   0.023   0.049   0.213   1.219   1.724   1.724   5.751   0.022   0.003   0.010   -0.103   -0.113   -1.365   1.517    13   0.127   0.693
 38.0   126.0     0.0   0.143   0.024   0.051   0.218   1.205   1.724   1.724   5.741   0.022   0.003   0.010   -0.103   -0.111   -1.339   1.488    13   0.127   0.695
 39.0   126.8     0.0   0.147   0.024   0.052   0.223   1.190   1.724   1.724   5.732   0.021   0.003   0.009   -0.102   -0.109   -1.315   1.461    13   0.127   0.697
 40.0     0.0     0.0   0.150   0.024   0.053   0.227   1.175   1.724   1.724   5.725   0.005   0.000   -0.006   -0.102   -0.026   0.023   -0.007     0   0.128   0.698
 41.0     0.0     0.0   0.150   0.024   0.053   0.227   1.160   1.724   1.724   5.802   0.005   0.000   -0.006   -0.094   -0.026   0.023   -0.007     0   0.126   0.700
 42.0     0.0     0.0   0.151   0.024   0.052   0.227   1.146   1.724   1.724   5.869   0.005   0.000   -0.006   -0.086   -0.025   0.023   -0.007     0   0.125   0.688
 43.0     0.0     0.0   0.152   0.025   0.051   0.227   1.133   1.724   1.724   5.930   0.005   0.000   -0.006   -0.080   -0.025   0.022   -0.007     0   0.124   0.677
 44.0     0.0     0.0   0.153   0.025   0.050   0.227   1.121   1.724   1.724   5.985   0.005   0.000   -0.006   -0.074   -0.025   0.022   -0.006     0   0.123   0.666
 45.0     0.0     0.0   0.153   0.025   0.049   0.227   1.109   1.724   1.724   6.035   0.005   0.000   -0.006   -0.069   -0.024   0.021   -0.006     0   0.122   0.656
 46.0     0.0     0.0   0.154   0.025   0.048   0.227   1.099   1.724   1.724   6.080   0.004   0.000   -0.006   -0.064   -0.024   0.021   -0.006     0   0.121   0.645
 47.0     0.0     0.0   0.155   0.025   0.047   0.226   1.089   1.724   1.724   6.120   0.004   0.000   -0.005   -0.060   -0.023   0.020   -0.006     0   0.120   0.635

|     |I (umol/m2 s) |         Biomass (g/L)         |      Compounds (mM)   |        |                      Rates (mmol/gDW h)                 |     |
 Time   intI   extI      X      TAG     STA      XT      N       C       O       Qn     rx     rTAG     rSTA   rN_kin     rN       rC      rO2     AI      LR      SP
 48.0   127.5     0.0   0.155   0.025   0.046   0.226   1.079   1.724   1.724   6.157   0.023   0.003   0.014   -0.056   -0.118   -1.566   1.726    14   0.120   0.625
 49.0   128.3     0.0   0.159   0.025   0.048   0.233   1.071   1.724   1.724   6.096   0.023   0.003   0.014   -0.061   -0.117   -1.581   1.741    13   0.121   0.616
{Operation terminated by user during <a href="matlab:matlab.internal.language.introspective.errorDocCallback('glpk', '/home/juan/cobratoolbox/external/base/solvers/glpkmex/glpk.m', 508)" style="font-weight:bold">glpk</a> (<a href="matlab: opentoline('/home/juan/cobratoolbox/external/base/solvers/glpkmex/glpk.m',508,0)">line 508</a>)

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('solveCobraLP>solveGlpk', '/home/juan/cobratoolbox/src/base/solvers/solveCobraLP.m', 1740)" style="font-weight:bold">solveCobraLP>solveGlpk</a> (<a href="matlab: opentoline('/home/juan/cobratoolbox/src/base/solvers/solveCobraLP.m',1740,0)">line 1740</a>)
[x,f,origStat,extra] = glpk(c,A,b,lb,ub,csense,[],osense,params);
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('solveCobraLP', '/home/juan/cobratoolbox/src/base/solvers/solveCobraLP.m', 500)" style="font-weight:bold">solveCobraLP</a> (<a href="matlab: opentoline('/home/juan/cobratoolbox/src/base/solvers/solveCobraLP.m',500,0)">line 500</a>)
        [x, f, y, w, stat, origStat] = solveGlpk(c, A, b, lb, ub, csense, osense, param);
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('optimizeCbModel', '/home/juan/cobratoolbox/src/analysis/FBA/optimizeCbModel.m', 347)" style="font-weight:bold">optimizeCbModel</a> (<a href="matlab: opentoline('/home/juan/cobratoolbox/src/analysis/FBA/optimizeCbModel.m',347,0)">line 347</a>)
    solution = solveCobraLP(LPproblem);
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('FBAcalc', '/home/juan/thesis/photoBioreactor_v12/calculation/FBAcalc.m', 70)" style="font-weight:bold">FBAcalc</a> (<a href="matlab: opentoline('/home/juan/thesis/photoBioreactor_v12/calculation/FBAcalc.m',70,0)">line 70</a>)
                    lipidFBA = optimizeCbModel(changeObjective(model,PBR.methods.objectiveFunctionLipid));
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('sFBA', '/home/juan/thesis/photoBioreactor_v12/calculation/sFBA.m', 71)" style="font-weight:bold">sFBA</a> (<a href="matlab: opentoline('/home/juan/thesis/photoBioreactor_v12/calculation/sFBA.m',71,0)">line 71</a>)
    solution = FBAcalc(PBR,solution);
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('evaluateModel_opt', '/home/juan/thesis/photoBioreactor_v12/optimization/evaluateModel_opt.m', 6)" style="font-weight:bold">evaluateModel_opt</a> (<a href="matlab: opentoline('/home/juan/thesis/photoBioreactor_v12/optimization/evaluateModel_opt.m',6,0)">line 6</a>)
solution = sFBA(PBR,'printLevel',1,'fixedTime',0);
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('fitnessFunction', '/home/juan/thesis/photoBioreactor_v12/optimization/fitnessFunction.m', 5)" style="font-weight:bold">fitnessFunction</a> (<a href="matlab: opentoline('/home/juan/thesis/photoBioreactor_v12/optimization/fitnessFunction.m',5,0)">line 5</a>)
solution = evaluateModel_opt(P,dataLibrary);} 
clc
clear
edit intensityProf.m
optimizationPBR
[Warning: File 'optlog.txt' not found.] 
[> In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('optimizationPBR', '/home/juan/thesis/photoBioreactor_v12/optimization/optimizationPBR.m', 5)" style="font-weight:bold">optimizationPBR</a> (<a href="matlab: opentoline('/home/juan/thesis/photoBioreactor_v12/optimization/optimizationPBR.m',5,0)">line 5</a>)] 
